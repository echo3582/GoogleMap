{"version":3,"sources":["template/map.js","template/filterItems.js","template/filterInput.js","template/filter.js","App.js","index.js"],"names":["map","marker","infowindow","FilterItem","props","initLocations","onHandlePick","locations","react_default","a","createElement","location","key","id","className","value","title","onClick","event","filteredLocations","filter","pickOneLocation","target","FilterInput","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","handleChange","query","setState","_this$props","onHandleChange","indexOf","state","_this2","autoFocus","type","placeholder","onChange","Component","Filter","filterInput","filterItems","errorHandler","document","getElementById","insertAdjacentHTML","console","log","Map","loaded","src","err","ref","window","getElementsByTagName","script","async","defer","onerror","parentNode","insertBefore","loadJS","google","maps","center","position","zoom","Marker","animation","Animation","DROP","url","InfoWindow","content","concat","info","maxWidth","mar","addListener","open","setAnimation","BOUNCE","setTimeout","panTo","addMap","fetch","then","res","json","infos","addMarker","addInfo","clickListener","mapLocations","initMap","bind","renderMap","App","updateLocations","_","newLocations","_this$state","pickLocation","template_map","_this3","data","ReactDOM","render","HashRouter","src_App"],"mappings":"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","file":"static/js/main.bb36c28e.chunk.js","sourcesContent":["import React, { Component } from 'react';\r\n/**\r\n* @description 加载Google maps\r\n* @param {string} src - Google maps脚本地址\r\n*/\r\n\r\nlet map, marker, infowindow;\r\n\r\nfunction loadJS(src, err) {\r\n  let ref = window.document.getElementsByTagName(\"script\")[0];\r\n  let script = window.document.createElement(\"script\");\r\n  script.src = src;\r\n  script.async = true;\r\n  script.defer = true;\r\n  script.onerror = err();\r\n  ref.parentNode.insertBefore(script, ref);\r\n}\r\n\r\nfunction errorHandler() {\r\n  document.getElementById('map').insertAdjacentHTML('afterbegin', `Oops, the map can't be loaded!`)\r\n  console.log(\"Oops, the map can't be loaded!\");\r\n}\r\n\r\n\r\n\r\nclass Map extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      loaded: false\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    loadJS(\"https://maps.googleapis.com/maps/api/js?key=AIzaSyBEbHiCAD3pznHIe2nzSWIPuZ2prAUQdeE&libraries=places&callback=initMap\", errorHandler);\r\n    // loadJS(\"https://maps.googleapis.com/maps/api/js?key=AIzaSyBEbHiCAD3pznHIe2nzSWPuZ2prAUQdeE&libraries=places&callback=initMap\", errorHandler);\r\n  }\r\n\r\n  /**\r\n  * @description 添加地图\r\n  * @param {array} locations - 地点们\r\n  * @param {object} map - 地图\r\n  * @param {object} locations[0].marker.position - 第一个地点的位置\r\n  */\r\n  addMap(locations) {\r\n    map = new window.google.maps.Map(document.getElementById('map'), {\r\n      center: locations[0].marker.position,\r\n      zoom: 11\r\n    });\r\n    return map;\r\n  }\r\n\r\n  /**\r\n  * @description 为地图添加地点标记\r\n  * @param {object} location - 地点信息\r\n  * @param {object} marker - 地点标记\r\n  * @param {object} location.marker.position - 位置信息\r\n  * @param {object} location.marker.title - 位置名称\r\n  */\r\n  addMarker(location) {\r\n    marker = new window.google.maps.Marker({\r\n      position: location.marker.position,\r\n      title: location.marker.title,\r\n      map: map,\r\n      animation: window.google.maps.Animation.DROP\r\n    });\r\n    return marker;\r\n  }\r\n\r\n  /**\r\n  * @description 为地点添加信息窗口和维基百科词条链接\r\n  */\r\n  addInfo(location, url) {\r\n    infowindow = new window.google.maps.InfoWindow({\r\n      content: `${location.info}</br><a href=${url} target=\"_blank\">维基百科</a>`,\r\n      maxWidth: 200\r\n    });\r\n    return infowindow;\r\n  }\r\n\r\n  /**\r\n  * @description 为信息窗口添加点击监听事件\r\n  */\r\n  clickListener(mar, info) {\r\n    return mar.addListener('click', function () {\r\n      /**\r\n      * @description 打开该标记的信息窗口\r\n      */\r\n      info.open(map, mar);\r\n      /**\r\n      * @description 为标记添加动画效果\r\n      */\r\n      mar.setAnimation(window.google.maps.Animation.BOUNCE);\r\n      /**\r\n      * @description 1s后停止动画\r\n      */\r\n      setTimeout(function () {\r\n        mar.setAnimation(null)\r\n      }, 1000);\r\n      /**\r\n      * @description 平滑移动中心点\r\n      */\r\n      map.panTo(mar.position);\r\n    })\r\n  }\r\n\r\n  /**\r\n  * @description 渲染地图\r\n  */\r\n  renderMap(locations) {\r\n    /**\r\n    * @description 添加地图\r\n    */\r\n    this.addMap(locations);\r\n    /**\r\n    * @description 为每一个地点添加标记、窗口信息和点击监听事件\r\n    */\r\n    locations.map((location) => {\r\n      fetch(`https://zh.wikipedia.org//w/api.php?action=opensearch&origin=*&format=json&search=${location.marker.title}&utf8=1\"`)\r\n        .then(res => res.json())\r\n        .then(infos => infos[3][0])\r\n        .then((url) => {\r\n          /**\r\n          * @description 添加标记\r\n          */\r\n          this.addMarker(location);\r\n          /**\r\n          * @description 添加窗口信息\r\n          */\r\n          this.addInfo(location, url);\r\n          /**\r\n          * @description 添加点击监听事件\r\n          */\r\n          this.clickListener(marker, infowindow);\r\n        })\r\n    });\r\n  };\r\n\r\n  initMap() {\r\n\r\n    const { mapLocations } = this.props;\r\n    this.addMap(mapLocations);\r\n    this.setState({\r\n      loaded: true\r\n    });\r\n\r\n  }\r\n\r\n  render() {\r\n\r\n    const { mapLocations } = this.props;\r\n    const { loaded } = this.state;\r\n\r\n    window.initMap = this.initMap.bind(this);\r\n\r\n    loaded ? this.renderMap(mapLocations) : console.log('loading');\r\n\r\n    return (\r\n      <div id = \"map\"> </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Map;","import React from 'react';\r\n\r\nconst FilterItem = (props) => {\r\n\t/**\r\n\t* @param {array} initLocations - 初始地点数据\r\n\t* @param {array} locations - 列表正在显示的地点数据\r\n\t* @param {function} onHandlePick - 地图仅显示被点击地点的标记\r\n\t*/\r\n\tconst { initLocations, onHandlePick, locations } = props;\r\n\r\n\t/**\r\n\t* @description 筛选出用户点击的地点数据，并使地图仅显示该地点的标记\r\n\t* @param {string} value - 被点击的地点\r\n\t* @param {array} filteredLocations - 被筛选出的地点数据\r\n\t*/\r\n\tfunction pickOneLocation (value) {\r\n\t\tlet filteredLocations = initLocations.filter((location) => (\r\n\t\t\tlocation.marker.title === value));\r\n\t\tlet location = filteredLocations[0] ? filteredLocations : initLocations;\r\n\t\tonHandlePick(location);\r\n\t}\r\n\treturn (\r\n\t\t\t<ul>\r\n\t\t\t\t{\r\n\t\t\t\t\tlocations.map((location) => (\r\n\t\t\t\t\t\t<li key={location.id} className=\"filterItem\">\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tclassName=\"buttonItem\"\r\n\t\t\t\t\t\t\t\tvalue={location.marker.title}\r\n\t\t\t\t\t\t\t\tonClick={(event) => pickOneLocation(event.target.value)}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{location.marker.title}\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t  \t\t</li>\r\n\t\t\t\t\t))\r\n\t\t\t\t}\r\n\t\t\t</ul>\r\n\t\t)\r\n}\r\n\r\nexport default FilterItem;","import React, { Component } from 'react';\r\n\r\nclass FilterInput extends Component {\r\n\t/**\r\n\t* @param {string} query - 用户输入\r\n\t*/\r\n\tconstructor (props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tquery: ''\r\n\t\t};\r\n\t}\r\n\r\n\t/**\r\n\t* @description 筛选出与用户输入匹配的地点项们\r\n\t* @param {array} initLocations - 初始地点数据\r\n\t* @param {array} filteredLocations - 被筛选出的地点数据\r\n\t* @param {array} newLocations - 应显示地点数据\r\n\t* @param {function} onHandleChange - 更新列表和地图显示\r\n\t*/\r\n\thandleChange = (query) => {\r\n\t\tthis.setState({ query: query });\r\n\t\tconst { initLocations, onHandleChange } = this.props;\r\n\t\tlet filteredLocations = initLocations.filter((location) => (\r\n\t\t\tlocation.marker.title.indexOf(query) !== -1));\r\n\t\tlet newLocations = filteredLocations[0] ? filteredLocations : initLocations;\r\n\t\tonHandleChange(newLocations);\r\n\t};\r\n\r\n\trender () {\r\n\t\tconst { query } = this.state;\r\n\t\treturn (\r\n\t\t  <input\r\n\t\t  \tautoFocus\r\n\t\t  \ttype=\"text\"\r\n\t\t  \tplaceholder=\"Filter\"\r\n\t\t  \tvalue={query}\r\n\t\t  \tonChange={(event) => this.handleChange(event.target.value)}\r\n\t\t  />\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default FilterInput;","import React from 'react';\r\nimport FilterItem from './filterItems';\r\nimport FilterInput from './filterInput';\r\n\r\nconst Filter = (props) => {\r\n\tconst { initLocations, locations, onHandleChange, onHandlePick } = props;\r\n\treturn (\r\n\t\t<div className=\"filter\">\r\n\t      \t<h2>Filter Tool</h2>\r\n\t      \t<FilterInput\r\n\t      \t\tinitLocations={initLocations}\r\n\t      \t\tlocations={locations}\r\n\t      \t\tonHandleChange={onHandleChange}\r\n\t      \t/>\r\n\t        <FilterItem\r\n\t        \tinitLocations={initLocations}\r\n\t        \tlocations={locations}\r\n\t        \tonHandlePick={onHandlePick}\r\n\t        />\r\n      \t</div>\r\n\t)\r\n}\r\n\r\nexport default Filter;","import React, { Component } from 'react';\r\nimport Filter from './template/filter';\r\nimport GoogleMap from './template/map';\r\nimport * as _ from 'lodash';\r\n\r\nclass App extends Component {\r\n\t/**\r\n\t* @param {array} initLocations - 初始地点数据\r\n\t* @param {array} locations - 列表正在显示的地点数据\r\n\t* @param {array} mapLocations - 地图正在显示marker的地点的数据\r\n\t*/\r\n\tconstructor (props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tinitLocations: [],\r\n\t\t\tlocations: [],\r\n\t\t\tmapLocations: []\r\n\t\t};\r\n\t}\r\n\r\n\t/**\r\n\t* @description 同步更新列表和地图标记为筛选后地点，与此同时，该函数具备防抖功能\r\n\t* @param {array} newLocations - 筛选后数组\r\n\t*/\r\n\tupdateLocations = _.debounce((newLocations) => {\r\n\t\tthis.setState({\r\n\t\t\tlocations: newLocations,\r\n\t\t\tmapLocations: newLocations\r\n\t\t})\r\n\t}, 600);\r\n\r\n\t/**\r\n\t* @description 当用户点击列表中某地点项时，地图仅显示该地点的标记\r\n\t* @param {array} location - 被点击的地点项\r\n\t*/\r\n\tpickLocation (location) {\r\n\t\tthis.setState({ mapLocations: location });\r\n\t\tconsole.log(this.state.mapLocations+\"App\");\r\n\t}\r\n\r\n \trender() {\r\n\t\tconst { locations, initLocations, mapLocations } = this.state;\r\n\t    return (\r\n\t      <div className=\"container\">\r\n\t      \t<div className=\"row\">\r\n\t\t\t\t<Filter\r\n\t\t\t\t\tinitLocations={initLocations}\r\n\t\t\t\t\tlocations={locations}\r\n\t\t\t\t\tonHandleChange={(newLocations) => this.updateLocations(newLocations)}\r\n\t\t\t\t\tonHandlePick={(location) => this.pickLocation(location)}\r\n\t\t\t\t/>\r\n\t       \t \t<GoogleMap\r\n\t\t\t\t\tlocations={locations}\r\n\t\t\t\t\tmapLocations={mapLocations}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t      </div>\r\n\t    )\r\n  \t}\r\n\r\n  \t/**\r\n\t* @description 获取locations.json中的数据并初始化initLocations、locations、mapLocations\r\n\t*/\r\n  \tcomponentDidMount () {\r\n  \t\tfetch('http://www.qianqianx.com/map-Udacity/api/locations.json')\r\n    \t.then((res) => res.json())\r\n    \t.then((info) => {\r\n\t \t\tthis.setState({\r\n\t\t\t\tinitLocations: info.data.locations,\r\n\t  \t\t\tlocations: info.data.locations,\r\n\t  \t\t\tmapLocations: info.data.locations\r\n\t\t\t})\r\n    \t})\r\n  \t}\r\n}\r\n\r\nexport default App;","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { HashRouter } from 'react-router-dom';\r\nimport './index.css';\r\nimport App from './App';\r\n\r\nReactDOM.render(\r\n    <HashRouter><App /></HashRouter>,\r\n    document.getElementById('root')\r\n)\r\n"],"sourceRoot":""}