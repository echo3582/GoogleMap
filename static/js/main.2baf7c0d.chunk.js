(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{14:function(t,n,e){t.exports=e(27)},19:function(t,n,e){},27:function(t,n,e){"use strict";e.r(n);var a,o,i,c,r=e(0),s=e.n(r),l=e(12),u=e.n(l),p=e(29),d=(e(19),e(2)),m=e(3),f=e(6),h=e(4),k=e(7),v=function(t){var n=t.initLocations,e=t.onHandlePick,a=t.locations;return s.a.createElement("ul",null,a.map(function(t){return s.a.createElement("li",{key:t.id,className:"filterItem"},s.a.createElement("button",{className:"buttonItem",value:t.marker.title,onClick:function(t){return function(t){var a=n.filter(function(n){return n.marker.title===t}),o=a[0]?a:n;e(o)}(t.target.value)}},t.marker.title))}))},w=function(t){function n(t){var e;return Object(d.a)(this,n),(e=Object(f.a)(this,Object(h.a)(n).call(this,t))).handleChange=function(t){e.setState({query:t});var n=e.props,a=n.initLocations,o=n.onHandleChange,i=a.filter(function(n){return-1!==n.marker.title.indexOf(t)});o(i[0]?i:a)},e.state={query:""},e}return Object(k.a)(n,t),Object(m.a)(n,[{key:"render",value:function(){var t=this,n=this.state.query;return s.a.createElement("input",{autoFocus:!0,type:"text",placeholder:"Filter",value:n,onChange:function(n){return t.handleChange(n.target.value)}})}}]),n}(r.Component),g=function(t){var n=t.initLocations,e=t.locations,a=t.onHandleChange,o=t.onHandlePick;return s.a.createElement("div",{className:"filter"},s.a.createElement("h2",null,"Filter Tool"),s.a.createElement(w,{initLocations:n,locations:e,onHandleChange:a}),s.a.createElement(v,{initLocations:n,locations:e,onHandlePick:o}))};var b=function(t){function n(t){var e;return Object(d.a)(this,n),(e=Object(f.a)(this,Object(h.a)(n).call(this,t))).state={loaded:!1},e}return Object(k.a)(n,t),Object(m.a)(n,[{key:"componentDidMount",value:function(){!function(t,n){var e=window.document.getElementsByTagName("script")[0],a=window.document.createElement("script");a.src=t,a.async=!0,a.defer=!0,e.parentNode.insertBefore(a,e)}("https://maps.googleapis.com/maps/api/js?key=AIzaSyBEbHiCAD3pznHIe2nzSWIPuZ2prAUQdeE&libraries=places&callback=initMap")}},{key:"addMap",value:function(t){return a=new window.google.maps.Map(document.getElementById("map"),{center:t[0].marker.position,zoom:11})}},{key:"addMarker",value:function(t){return o=new window.google.maps.Marker({position:t.marker.position,title:t.marker.title,map:a,animation:window.google.maps.Animation.DROP})}},{key:"addInfo",value:function(t,n){return i=new window.google.maps.InfoWindow({content:"".concat(t.info,"</br><a href=").concat(n,' target="_blank">\u7ef4\u57fa\u767e\u79d1</a>'),maxWidth:200})}},{key:"clickListener",value:function(t,n){return t.addListener("click",function(){c&&c.close(),n.open(a,t),c=n,t.setAnimation(window.google.maps.Animation.BOUNCE),setTimeout(function(){t.setAnimation(null)},1e3),a.panTo(t.position)})}},{key:"renderMap",value:function(t){var n=this;this.addMap(t),t.map(function(t){fetch("https://zh.wikipedia.org//w/api.php?action=opensearch&origin=*&format=json&search=".concat(t.marker.title,'&utf8=1"')).then(function(t){return t.json()}).then(function(t){return t[3][0]}).then(function(e){n.addMarker(t),n.addInfo(t,e),n.clickListener(o,i)})})}},{key:"initMap",value:function(){var t=this.props.mapLocations;this.addMap(t),this.setState({loaded:!0})}},{key:"componentDidUpdate",value:function(){var t=this.props.mapLocations,n=this.state.loaded;window.initMap=this.initMap.bind(this),n?this.renderMap(t):console.log("loading")}},{key:"render",value:function(){return s.a.createElement("div",{id:"map"}," ")}}]),n}(r.Component),y=e(13),L=function(t){function n(t){var e;return Object(d.a)(this,n),(e=Object(f.a)(this,Object(h.a)(n).call(this,t))).updateLocations=y.debounce(function(t){e.setState({locations:t,mapLocations:t})},600),e.state={initLocations:[],locations:[],mapLocations:[]},e}return Object(k.a)(n,t),Object(m.a)(n,[{key:"pickLocation",value:function(t){this.setState({mapLocations:t}),console.log(this.state.mapLocations+"App")}},{key:"render",value:function(){var t=this,n=this.state,e=n.locations,a=n.initLocations,o=n.mapLocations;return s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"row"},s.a.createElement(g,{initLocations:a,locations:e,onHandleChange:function(n){return t.updateLocations(n)},onHandlePick:function(n){return t.pickLocation(n)}}),s.a.createElement(b,{locations:e,mapLocations:o})))}},{key:"componentDidMount",value:function(){var t=this;fetch("http://www.qianqianx.com/map-Udacity/api/locations.json").then(function(t){return t.json()}).then(function(n){t.setState({initLocations:n.data.locations,locations:n.data.locations,mapLocations:n.data.locations})})}}]),n}(r.Component);u.a.render(s.a.createElement(p.a,null,s.a.createElement(L,null)),document.getElementById("root"))}},[[14,2,1]]]);
//# sourceMappingURL=main.2baf7c0d.chunk.js.map