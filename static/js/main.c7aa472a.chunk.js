(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{14:function(e,t,n){e.exports=n(27)},19:function(e,t,n){},27:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(12),r=n.n(i),c=n(29),l=(n(19),n(2)),s=n(3),u=n(6),m=n(4),d=n(7),p=function(e){var t=e.initLocations,n=e.onHandlePick,a=e.locations;return o.a.createElement("ul",null,a.map(function(e){return o.a.createElement("li",{key:e.id,className:"filterItem"},o.a.createElement("button",{className:"buttonItem",value:e.marker.title,onClick:function(e){return function(e){var a=t.filter(function(t){return t.marker.title===e}),o=a[0]?a:t;n(o)}(e.target.value)}},e.marker.title))}))},f=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){n.setState({query:e});var t=n.props,a=t.initLocations,o=t.onHandleChange,i=a.filter(function(t){return-1!==t.marker.title.indexOf(e)});o(i[0]?i:a)},n.state={query:""},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.state.query;return o.a.createElement("input",{autoFocus:!0,type:"text",placeholder:"Filter",value:t,onChange:function(t){return e.handleChange(t.target.value)}})}}]),t}(a.Component),k=function(e){var t=e.initLocations,n=e.locations,a=e.onHandleChange,i=e.onHandlePick;return o.a.createElement("div",{className:"filter"},o.a.createElement("h2",null,"Filter Tool"),o.a.createElement(f,{initLocations:t,locations:n,onHandleChange:a}),o.a.createElement(p,{initLocations:t,locations:n,onHandlePick:i}))},h=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={loaded:!1},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){t.loadJS("https://maps.googleapis.com/maps/api/js?key=AIzaSyBEbHiCAD3pznHIe2nzSWIPuZ2prAUQdeE&libraries=places&callback=initMap",t.errorHandler)}},{key:"clickListener",value:function(e,n){return e.addListener("click",function(){t.globalInfo&&t.globalInfo.close(),n.open(t.map,e),t.globalInfo=n,e.setAnimation(window.google.maps.Animation.BOUNCE),setTimeout(function(){e.setAnimation(null)},1e3),t.map.panTo(e.position)})}},{key:"renderMap",value:function(e,n){var a=this;t.clearMarkers(),e.map(function(e){return fetch("https://zh.wikipedia.org//w/api.php?action=opensearch&origin=*&format=json&search=".concat(e.marker.title,'&utf8=1"')).then(function(e){return e.json()}).then(function(e){return e[3][0]}).then(function(o){t.addMarker(e),t.addInfo(e,o),a.clickListener(t.marker,t.infoWindow),n&&t.map.panTo(e.marker.position)}),null})}},{key:"initMap",value:function(){var e=this.props.mapLocations;t.addMap(e),this.setState({loaded:!0})}},{key:"componentDidUpdate",value:function(){var e=this.props,t=e.mapLocations,n=e.itemIsClicked,a=this.state.loaded;window.initMap=this.initMap.bind(this),a&&this.renderMap(t,n)}},{key:"render",value:function(){return o.a.createElement("div",{id:"map"}," ")}}],[{key:"loadJS",value:function(e,t){var n=window.document.getElementsByTagName("script")[0],a=window.document.createElement("script");a.src=e,a.async=!0,a.defer=!0,a.onerror=t,n.parentNode.insertBefore(a,n)}},{key:"errorHandler",value:function(){document.getElementById("map").insertAdjacentHTML("afterbegin","Oops, the map can't be loaded! Maybe you need a tool to visit google ~")}},{key:"addMap",value:function(e){return t.map=new window.google.maps.Map(document.getElementById("map"),{center:e[0].marker.position,zoom:11}),t.map}},{key:"addMarker",value:function(e){return t.marker=new window.google.maps.Marker({position:e.marker.position,title:e.marker.title,map:t.map,animation:window.google.maps.Animation.DROP}),t.markers.push(t.marker),t.marker}},{key:"setMapOnAll",value:function(e){t.markers.map(function(t){return t.setMap(e),null})}},{key:"clearMarkers",value:function(){t.setMapOnAll(null),t.markers=[]}},{key:"addInfo",value:function(e,n){return t.infoWindow=new window.google.maps.InfoWindow({content:"".concat(e.info,"</br><a href=").concat(n,' target="_blank">\u7ef4\u57fa\u767e\u79d1</a>'),maxWidth:200}),t.infoWindow}}]),t}(a.Component);h.markers=[];var v=h,g=n(13),w=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).updateLocations=g.debounce(function(e){n.setState({locations:e,mapLocations:e})},600),n.state={initLocations:[],locations:[],mapLocations:[],itemIsClicked:!1},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"pickLocation",value:function(e){this.setState({mapLocations:e,itemIsClicked:!0})}},{key:"render",value:function(){var e=this,t=this.state,n=t.locations,a=t.initLocations,i=t.mapLocations,r=t.itemIsClicked;return o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"row"},o.a.createElement(k,{initLocations:a,locations:n,onHandleChange:function(t){return e.updateLocations(t)},onHandlePick:function(t){return e.pickLocation(t)}}),o.a.createElement(v,{locations:n,mapLocations:i,itemIsClicked:r})))}},{key:"componentDidMount",value:function(){var e=this;fetch("http://www.qianqianx.com/map-Udacity/api/locations.json").then(function(e){return e.json()}).then(function(t){e.setState({initLocations:t.data.locations,locations:t.data.locations,mapLocations:t.data.locations})})}}]),t}(a.Component);r.a.render(o.a.createElement(c.a,null,o.a.createElement(w,null)),document.getElementById("root"))}},[[14,2,1]]]);
//# sourceMappingURL=main.c7aa472a.chunk.js.map