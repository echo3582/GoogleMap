(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{108:function(e,n,t){e.exports=t(190)},113:function(e,n,t){},190:function(e,n,t){"use strict";t.r(n);var a=t(1),o=t.n(a),i=t(5),r=t.n(i),c=t(194),l=(t(113),t(36)),s=t(37),u=t(41),p=t(38),m=t(42),d=t(192),f=function(e){var n=e.initLocations,t=e.onHandlePick,a=e.locations;return o.a.createElement("ul",null,a.map(function(e){return o.a.createElement(d.a,{key:e.id,className:"filterItem"},o.a.createElement("button",{className:"buttonItem",value:e.marker.title,onClick:function(e){return function(e){var a=n.filter(function(n){return n.marker.title===e}),o=a[0]?a:n;t(o)}(e.target.value)}},e.marker.title))}))},k=t(193),h=function(e){function n(e){var t;return Object(l.a)(this,n),(t=Object(u.a)(this,Object(p.a)(n).call(this,e))).handleChange=function(e){t.setState({query:e});var n=t.props,a=n.initLocations;(0,n.onHandleChange)(a.filter(function(n){return-1!==n.marker.title.indexOf(e)}))},t.state={query:""},t}return Object(m.a)(n,e),Object(s.a)(n,[{key:"render",value:function(){var e=this,n=this.state.query;return o.a.createElement(k.a,{autoFocus:!0,type:"text",placeholder:"Filter",value:n,onChange:function(n){return e.handleChange(n.target.value)}})}}]),n}(a.Component),v=function(e){var n=e.initLocations,t=e.locations,a=e.onHandleChange,i=e.onHandlePick;return o.a.createElement("div",{className:"filter"},o.a.createElement("h2",null,"Filter Tool"),o.a.createElement(h,{initLocations:n,locations:t,onHandleChange:a}),o.a.createElement(f,{initLocations:n,locations:t,onHandlePick:i}))},g=t(47),w=function(e){function n(e){var t;return Object(l.a)(this,n),t=Object(u.a)(this,Object(p.a)(n).call(this,e)),window.initMap=t.initMap.bind(Object(g.a)(Object(g.a)(t))),t}return Object(m.a)(n,e),Object(s.a)(n,[{key:"componentDidMount",value:function(){n.loadJS("https://maps.googleapis.com/maps/api/js?key=AIzaSyBEbHiCAD3pznHIe2nzSWIPuZ2prAUQdeE&libraries=places&callback=initMap",n.errorHandler)}},{key:"clickListener",value:function(e,t){return e.addListener("click",function(){n.globalInfo&&n.globalInfo.close(),t.open(n.map,e),n.globalInfo=t,e.setAnimation(window.google.maps.Animation.BOUNCE),setTimeout(function(){e.setAnimation(null)},1e3),n.map.panTo(e.position)})}},{key:"updateMap",value:function(e){var t=this;n.clearMarkers(),e.map(function(e){return fetch("https://zh.wikipedia.org//w/api.php?action=opensearch&origin=*&format=json&search=".concat(e.marker.title,'&utf8=1"')).then(function(e){return e.json()}).then(function(e){return e[3][0]}).then(function(a){n.addMarker(e),n.addInfo(e,a),t.clickListener(n.marker,n.infoWindow),n.map.panTo(e.marker.position)}),null})}},{key:"initMap",value:function(){var e=this.props.mapLocations;0!==e.length&&(n.addMap(e),this.updateMap(e),n.mapAdded=!0),n.mapLoaded=!0}},{key:"componentDidUpdate",value:function(){var e=this.props.mapLocations;n.mapAdded?this.updateMap(e):n.mapLoaded&&this.initMap()}},{key:"render",value:function(){return o.a.createElement("div",{id:"map"}," ")}}],[{key:"loadJS",value:function(e,n){var t=window.document.getElementsByTagName("script")[0],a=window.document.createElement("script");a.src=e,a.async=!0,a.onerror=n,t.parentNode.insertBefore(a,t)}},{key:"errorHandler",value:function(){document.getElementById("map").insertAdjacentHTML("afterbegin","Oops, the map can't be loaded! Maybe you need a tool to visit google ~")}},{key:"addMap",value:function(e){return n.map=new window.google.maps.Map(document.getElementById("map"),{center:e[0].marker.position,zoom:11}),n.map}},{key:"addMarker",value:function(e){return n.marker=new window.google.maps.Marker({position:e.marker.position,title:e.marker.title,map:n.map,animation:window.google.maps.Animation.DROP}),n.markers.push(n.marker),n.marker}},{key:"setMapOnAll",value:function(e){n.markers.map(function(n){return n.setMap(e),null})}},{key:"clearMarkers",value:function(){n.setMapOnAll(null),n.markers=[]}},{key:"addInfo",value:function(e,t){return n.infoWindow=new window.google.maps.InfoWindow({content:"".concat(e.info,"</br><a href=").concat(t,' target="_blank">\u7ef4\u57fa\u767e\u79d1</a>'),maxWidth:200}),n.infoWindow}}]),n}(a.Component);w.markers=[],w.mapLoaded=!1,w.mapAdded=!1;var b=w,y=t(104),L=function(e){function n(e){var t;return Object(l.a)(this,n),(t=Object(u.a)(this,Object(p.a)(n).call(this,e))).updateLocations=y.debounce(function(e){t.setState({locations:e,mapLocations:e})},600),t.state={initLocations:[],locations:[],mapLocations:[]},t}return Object(m.a)(n,e),Object(s.a)(n,[{key:"pickLocation",value:function(e){this.setState({mapLocations:e})}},{key:"render",value:function(){var e=this,n=this.state,t=n.locations,a=n.initLocations,i=n.mapLocations;return o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"row"},o.a.createElement(v,{initLocations:a,locations:t,onHandleChange:function(n){return e.updateLocations(n)},onHandlePick:function(n){return e.pickLocation(n)}}),o.a.createElement(b,{locations:t,mapLocations:i})))}},{key:"componentDidMount",value:function(){var e=this;fetch("http://www.qianqianx.com/map-Udacity/api/locations.json").then(function(e){return e.json()}).then(function(n){e.setState({initLocations:n.data.locations,locations:n.data.locations,mapLocations:n.data.locations})})}}]),n}(a.Component);r.a.render(o.a.createElement(c.a,null,o.a.createElement(L,null)),document.getElementById("root"))}},[[108,2,1]]]);
//# sourceMappingURL=main.24d4bc16.chunk.js.map